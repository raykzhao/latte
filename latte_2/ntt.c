#include <stdint.h>
#include "ntt.h"
#include "param.h"
#include "poly.h"
#include "red.h"

static const uint64_t inv_n = 33533955;

static const uint64_t root[N] = {0, 13932926, 11611772, 20051184, 5611999, 9265027, 19493511, 10764447, 24000204, 6177812, 32900457, 32410281, 23400652, 3198144, 2200199, 24124141, 28206570, 15280732, 17354707, 12498775, 18285219, 30499698, 12450192, 5644069, 11930096, 17535208, 32021213, 28870577, 16657861, 32738467, 28138468, 33049270, 3925647, 22891714, 32084204, 20016426, 19793647, 9217272, 18447657, 25090164, 17182522, 23808311, 16908244, 22122426, 17558876, 22883012, 6983968, 24272961, 875322, 18546326, 6067746, 24580770, 18170667, 10496054, 15608693, 2515533, 44602, 10865068, 23754885, 12096975, 16076627, 9986178, 14086122, 2292012, 29787612, 7503285, 11189900, 31631832, 5860566, 10986757, 28381447, 30095497, 6958801, 20465111, 274280, 27204547, 1594993, 13111549, 11767139, 10268342, 14317088, 12984689, 15944111, 30813171, 2694593, 26451815, 6406585, 20010985, 26966511, 30969403, 10350944, 17755942, 31244694, 16592269, 15029351, 31275530, 30598763, 9444158, 4158217, 295408, 1312494, 28869312, 28382998, 25119048, 21586133, 2174608, 971182, 16930314, 16089224, 33164555, 25578586, 11520949, 11902971, 25958325, 25622482, 5788647, 1512189, 23129892, 33548073, 33265110, 4757561, 33361188, 12394212, 24969419, 29092517, 24807116, 27320357, 356339, 33073869, 8792503, 17918503, 10321733, 7192988, 29800114, 26258901, 31299552, 27332300, 32966155, 12276016, 10730693, 23321992, 12553039, 24560419, 8395453, 9254376, 7168707, 20172936, 14752366, 28613855, 20608463, 19639872, 350844, 7143126, 5527986, 31109078, 5790148, 20006024, 4038243, 23863466, 5400208, 32661754, 7865111, 22892358, 26801289, 11396388, 5957087, 24061947, 10088648, 17583519, 17318481, 6137845, 22490456, 28710073, 23987117, 15764394, 27006783, 17495707, 8448824, 15301221, 7050722, 21141507, 32554080, 15212341, 26202716, 3544406, 5492562, 7467341, 15476051, 9331981, 23955081, 22876568, 26738484, 18765598, 549280, 27900090, 28595224, 9821018, 16583057, 2391744, 2331434, 32156118, 26379347, 28313524, 16811031, 10167038, 10798836, 29582106, 15015034, 6681561, 3320266, 8152825, 28274051, 3493835, 26996082, 7409310, 1126043, 24105137, 21309313, 1340079, 18429480, 20985077, 33504217, 25114323, 7283953, 23346277, 1993842, 23696636, 890780, 11970518, 5882189, 32328326, 6581391, 22682749, 21303665, 31075518, 5592919, 31118264, 21677573, 14228138, 11292275, 16675504, 22854030, 1831143, 6911566, 31256330, 23926560, 29285890, 9587262, 18068068, 16494188, 8860636, 9193484, 24253081, 11613809, 32254537, 31413463, 27232709, 3896072, 30042509, 20129086, 22904553, 20379828, 21212065, 15687720, 20691575, 32952995, 32565534, 12518132, 5256053, 18451917, 24239248, 20111043, 31825914, 28465609, 5277136, 16825324, 10271655, 20022181, 2317077, 30283446, 5734558, 32455823, 30974828, 11609270, 15072519, 30193609, 12911336, 4227358, 10183453, 463310, 9774326, 11234114, 75884, 33448458, 7304537, 14467282, 2709331, 23833208, 22877897, 7418861, 11306056, 18346493, 9297142, 10037285, 20322627, 18184351, 20175867, 3725772, 25643931, 10580357, 5461710, 25229940, 8705659, 29665540, 11848146, 20162700, 28915623, 7530203, 14283308, 23962948, 32305531, 5502699, 28749023, 18787586, 18202673, 10942076, 8003366, 32577202, 20677157, 25416408, 32978892, 3984556, 32899383, 17426283, 6124832, 25933966, 10625416, 12027103, 28014979, 20499942, 7049318, 20028350, 30042775, 25527095, 13265618, 877005, 4748262, 18333851, 26075979, 31698112, 4844919, 20152535, 19292861, 10115093, 21858887, 17835509, 3135710, 13279759, 24043209, 5445832, 13421102, 7721062, 1547168, 11635830, 12917250, 8202979, 25612111, 1295974, 22325878, 4277667, 27903479, 23583590, 20695412, 7014022, 26382122, 12932209, 12214045, 16571708, 26910237, 23138846, 4832637, 23673320, 2227710, 8903251, 30171258, 12535137, 29552711, 13697612, 24090687, 8078178, 64970, 12008474, 19635474, 14526907, 336282, 14298749, 2379024, 20171520, 33199333, 24717469, 14235181, 27458022, 31584036, 21851610, 9177838, 16702025, 22395172, 30879357, 8274430, 24285067, 12692770, 19400126, 12531599, 19619603, 17834021, 15297664, 31747289, 14692371, 3272916, 13464285, 27286425, 17835832, 16760574, 5089239, 32232237, 5189923, 30194124, 13667231, 9051990, 33093494, 33430888, 1830280, 32980313, 17811927, 9179917, 5034607, 31221701, 5441314, 12770523, 12198279, 9127632, 31864517, 17481913, 11304912, 29909847, 23362288, 18156865, 11928505, 4560827, 8249900, 26118407, 16355948, 11333555, 17765316, 33332935, 4234761, 5726112, 30828641, 15188762, 19808946, 12831556, 15575095, 27007821, 9588406, 5000690, 31937856, 30010632, 21670250, 7826908, 9012663, 25104182, 18558091, 12637651, 19998931, 31687399, 834293, 23098868, 13429130, 23487698, 1568322, 4655594, 17625297, 30605794, 6699281, 21418804, 5323041, 15583618, 31854677, 4560369, 2234940, 33405664, 8847977, 6715352, 32043637, 32873864, 18079079, 22964028, 6518450, 29768905, 29346023, 4530494, 16150309, 9814960, 20532307, 22208228, 11713908, 16476889, 19482423, 7911167, 10484564, 16140402, 6447105, 31665116, 23767695, 2780563, 17869670, 9404295, 848841, 32629047, 21068037, 7710434, 24421521, 240496, 20695819, 13701138, 2396815, 2803287, 18894960, 11258953, 2765081, 20281245, 26752615, 8906401, 29911551, 16690005, 15804306, 19279545, 5770065, 2833673, 16232354, 16691581, 27858099, 20805124, 4475706, 18704727, 17613529, 8590759, 31609529, 8363883, 2256270, 11482490, 4089784, 33294688, 21304006, 17940359, 7858925, 6074363, 6875768, 3878176, 8923674, 24845334, 19972020, 5990259, 3630289, 26632775, 25201164, 6445825, 24480374, 18247334, 2949922, 272577, 5131893, 29670959, 20414810, 19867721, 30908476, 32068275, 24574473, 15920685, 30677498, 894060, 23189142, 32295411, 16320092, 2298665, 24940748, 25674046, 5823761, 23747222, 3025540, 5988686, 29854489, 30225455, 24001437, 21730033, 27713183, 6012741, 3528481, 8897965, 21676331, 18033088, 15228919, 21005058, 28686065, 6892168, 27052505, 18729418, 20590820, 1584153, 30002960, 18542256, 4569184, 13597301, 14551898, 33480570, 10845744, 26884976, 27766014, 16262753, 26173676, 24630546, 28063037, 25383979, 16834402, 13348528, 1334268, 24207608, 26083324, 30365683, 33547032, 27147969, 4897631, 12911768, 14003082, 2662408, 23508460, 21575023, 29731360, 3984339, 16474589, 27685245, 13961451, 11693178, 21267387, 8368644, 23321191, 33084602, 2216492, 12980504, 19181, 6053128, 15003595, 31208554, 10201657, 24679934, 9922594, 15423132, 15577932, 10901437, 9353490, 1443951, 16696601, 33368264, 29862065, 25038570, 1341343, 6900641, 4127917, 5750275, 6946564, 22565971, 16164654, 9733746, 19933055, 19079040, 9955171, 6730524, 31169079, 15628816, 31354522, 21465317, 8174651, 17503222, 7958143, 28372515, 695457, 21979500, 5067222, 21271900, 32339670, 22769169, 17312843, 25233952, 20710337, 14102142, 18121628, 9224481, 749815, 24883485, 19369468, 6194761, 1978950, 5131561, 24522330, 14450381, 8808468, 12960368, 6610911, 30295087, 1713195, 5297155, 27157032, 7927708, 30958905, 9271649, 6929317, 29799465, 32484769, 8588259, 6102179, 2397131, 25757355, 14599611, 1497837, 7766295, 30051284, 13117428, 25508761, 28579077, 13352107, 10989301, 10701619, 22576343, 33416658, 4834162, 22457635, 11088363, 153003, 4368825, 3236641, 8634703, 868712, 29715168, 15863008, 11737414, 25714152, 28888975, 29543210, 32284978, 25956985, 29422040, 23153726, 13235647, 31259067, 9642494, 2805554, 25452781, 6207922, 28645532, 17026711, 4302888, 33029443, 13394377, 20225355, 27867240, 28932015, 1365419, 15279351, 11249291, 19597434, 7434107, 14578940, 19896404, 6173216, 6272871, 20562775, 22448719, 2163409, 6035802, 10005182, 24509045, 17008965, 29886577, 662031, 22325782, 20744360, 22838078, 29921300, 30568998, 17771783, 9437475, 17299155, 22975252, 24411278, 9705055, 9694341, 18813803, 19322251, 31027752, 18810315, 31050986, 18329037, 31152002, 11612804, 18269624, 2231163, 12618057, 30778641, 26943672, 5285539, 1539591, 26256077, 21224443, 29250579, 21365294, 2879181, 16196915, 10677104, 20019882, 12571251, 32225980, 19857916, 5144438, 30427328, 9510849, 31848301, 3772681, 2820269, 10483609, 19250396, 24206040, 15453168, 21447014, 18035215, 4792123, 2179345, 4754875, 16692199, 32129510, 21960202, 8705995, 22357620, 12801881, 31531052, 27908409, 20203545, 23264067, 8678637, 30861826, 7420183, 6263953, 2041684, 19744301, 26444225, 4392651, 7453490, 18804730, 2574738, 25144655, 20174550, 19528549, 13963500, 19053016, 8810516, 3320168, 17816807, 29393809, 10898297, 2127100, 29155972, 22271477, 6834129, 5035063, 4866718, 33018263, 2409456, 15624251, 28393539, 7327451, 24141198, 1345737, 10399054, 3220079, 9163916, 9351785, 8607921, 6797175, 19397284, 29499140, 4592312, 30322594, 2555655, 22257512, 8616521, 20969802, 28630825, 20608355, 2492551, 32396397, 29427973, 17472566, 21286090, 1039441, 22906860, 20338393, 13976245, 11207131, 32305932, 29906544, 18515267, 16869337, 5617461, 18515316, 24944946, 5057582, 7155439, 11190086, 22793471, 2639227, 29227541, 4014761, 3443181, 22422759, 12407850, 31846843, 7821588, 16056022, 4411655, 2351055, 29377450, 20011414, 32191820, 18874520, 16790911, 23339271, 21768961, 14176779, 9993730, 9397587, 31716517, 20090213, 18216073, 30078229, 2104261, 14212175, 18187449, 19203236, 18310863, 17032478, 12077641, 5195695, 5186917, 31036549, 3217520, 6448528, 23205631, 17811591, 7877944, 4080872, 13002068, 25856238, 18107257, 26056062, 14355023, 11022993, 17613690, 25510315, 20184116, 24698124, 922118, 20095701, 21871282, 6601275, 111221, 26496762, 15045523, 26723079, 24604197, 7151845, 1217483, 22863823, 27548328, 459665, 16372471, 5613678, 27066770, 10579597, 6862239, 22754755, 27263243, 20382710, 11868374, 30780101, 29118505, 29410138, 10421426, 519219, 3988132, 9868578, 25420098, 11164635, 18772013, 19564648, 476596, 14849484, 25938701, 21776904, 2009122, 772984, 33246488, 14139696, 16124968, 7415294, 25946072, 7236041, 4059619, 3790890, 1394723, 33308840, 23442584, 25339160, 21872478, 21166332, 664201, 23978761, 10841414, 1291258, 24237808, 6799214, 611681, 27076845, 13305100, 3096285, 30408062, 10290170, 31112829, 22016368, 6807453, 21069914, 28795296, 3127892, 5981902, 12036763, 14124243, 24924751, 6933636, 7846116, 5030726, 14877387, 13375350, 4222711, 11473323, 28783461, 15864875, 25569853, 4952503, 8286972, 16706979, 9750253, 9194186, 7287049, 22578141, 33335510, 13732163, 18675824, 19973940, 32093448, 4287298, 6935636, 29031466, 26684071, 27869944, 7049525, 10733244, 10560053, 18152096, 434371, 2545760, 11868317, 23993174, 22792639, 8503351, 18877736, 18737256, 14442398, 9892227, 24749653, 24085365, 8043725, 22294418, 21554844, 24477249, 25311703, 21540165, 1443548, 7887769, 22874575, 28547247, 30979185, 11106028, 8471334, 4160383, 10035452, 20984361, 6043734, 29202282, 30669499, 15866137, 27677206, 5079751, 28915230, 25663670, 2018281, 18662291, 27024809, 29926414, 30277804, 8560623, 25436981, 12753155, 18261595, 20291762, 32464651, 5158201, 25863675, 28898868, 25298334, 11957334, 5947343, 32781607, 15980670, 15309552, 22460158, 12184768, 8849268, 32775864, 27828632, 2728601, 27575709, 14269444, 14098335, 24236487, 1217038, 18503150, 26222938, 1887611, 12094349, 20578909, 26131288, 6197596, 13758548, 11081804, 14994955, 33284751, 838124, 18990, 26236572, 4109120, 20639055, 13769776, 31315686, 1469958, 20030815, 8035828, 22807563, 30596720, 30484990, 31609948, 11405359, 29715981, 9884783, 19652022, 19365757, 31865355, 9897958, 3099240, 28559360, 31599943, 9641805, 1814789, 28360148, 26834228, 3750828, 10010733, 7340407, 31523235, 20035915, 26520485, 11561626, 29115785, 17593373, 1103079, 20748113, 20662899, 15111870, 8284248, 23895844, 21719845, 20255137, 27434940, 9031859, 2830868, 3948162, 7693448, 24038471, 9442828, 4424161, 20285029, 21439058, 28117541, 16957604, 15774422, 26207811, 6576335, 7599499, 23204729, 16392808, 7748524, 7003929, 32670885, 1581356, 6162384, 29275340, 2597256, 27226669, 2660921, 21684980, 33047798, 12252992, 6644521, 9151112, 16446987, 9728253, 19581865, 13372543, 1440412, 3425940, 1919177, 3310348, 31695082, 32253616, 22687562, 24876052, 26064844, 21052373, 31668352, 19624702, 26744064, 7470761, 3399634, 30777164, 30689787, 15021021, 33515916, 11120688, 11234837, 13479425, 23708315, 16419870, 695642, 5237256, 32666323, 29497257, 813331, 25375085, 2584222, 22188770, 13145110, 26868003, 31066286, 17112370, 20660822, 14183152, 32743642, 11211421, 15685938, 11171045, 10362117, 24379220, 17650591, 19144236, 20243469, 95006, 5774839, 28684708, 10107004, 1580337, 21934851, 19078192, 26801334, 25514185, 12699022, 13377927, 20138677, 10100989, 20660720, 2243900, 13047232, 11914019, 12531139, 5184597, 18103956, 11530181, 6882336, 7453831, 18545747, 16072042, 20241271, 21437043, 17623718, 24917783, 8308278, 25627871, 21182893, 17789720, 20252809, 8406982, 26639609, 3112352, 8469832, 4876303, 2174207, 1757688, 32467393, 21828148, 12199430, 8036454, 15880522, 2000470, 32200688, 2529761, 16829605, 31546294, 7167969, 25971088, 15653121, 3858036, 31578754, 22001426, 23448822, 26558482, 27444779, 27522011, 28695620, 21447913, 14458530, 26016292, 24608278, 20632486, 6466263, 4534802, 27896251, 32697091, 1365715, 30633344, 19387582, 23493344, 8177609, 32450850, 19349983, 25654522, 3897542, 13856306, 3332716, 9396603, 24360851, 11291, 459243, 19115019, 8664049, 21707885, 28538746, 7827879, 18248711, 24964649, 19458573, 26403703, 24438761, 14451294, 16110732, 2492033, 13024913, 20967978, 5994622, 24921422, 5847379, 19864981, 29792690, 23813315, 17768828, 13559965, 13404745, 2565051, 14547718, 766057, 20948309, 26825784, 29081669, 21589845, 25285773, 10398388, 22725415, 22251306, 3003655, 14199042, 276404, 21366871, 27692305, 20243463, 4950789, 24330316, 4494893, 6530311, 3441093, 2003746, 28049142, 12795637, 10768326, 7429906, 26067935, 25206292, 13609780, 1491762, 7293371, 11514562, 7893227, 25393055, 4759234, 12537755, 24722322, 2955698, 3108470, 7011914, 23555451, 23324417, 20520000, 8334585, 30781823, 31966781, 4941485, 25096670, 23776428, 23636663, 1619013, 16113041, 23198436, 29377518, 26525028, 1630968, 27883777, 25912287, 6866984, 23639218, 24332491, 23340169, 5432945, 20474190, 19244024, 14532167, 27321923, 6864748, 29110721, 2007372, 27468625, 28086231, 1320328, 18165985, 24458509, 29737739, 10630201, 33283283, 8945520, 25578651, 2119039, 16673741, 6879267, 24146947, 5029786, 3589982, 30321334, 32562917, 3934220, 23827161, 7391212, 24295655, 13865436, 20297292, 18030461, 10373945, 30330534, 8487595, 8357766, 20969302, 23529355, 11590769, 2363810, 33482003, 10033402, 28305127, 2934665, 28702878, 14322604, 6225297, 846785, 11772160, 27275960, 2300742, 21305005, 10805875, 22062059, 3741478, 15264255, 24461501, 11019198, 12359254, 2456399, 14355235, 28445487, 23073985, 9834888, 22705890, 8466399, 11786961, 23287118, 19863374, 24803680, 26947928, 24553009, 19158717, 26409821, 22926330, 16439981, 21821486, 26090266, 10894165, 23730600, 30651213, 7782969, 14242837, 14314814, 32206722, 23329706, 10192274, 22691763, 7174137, 26017386, 30764518, 19760594, 3132939, 19228756, 21469900, 5951233, 23408758, 28196596, 29402848, 29982937, 213835, 11038871, 25730393, 5676045, 10918351, 24910440, 12663652, 29632006, 17414394, 19588609, 5667121, 13393878, 359995, 19375686, 4450737, 19009626, 27419139, 7081102, 9437332, 4433020, 22816361, 27763256, 31293856, 172002, 30802412, 27943001, 27136954, 3228359, 30999395, 9295356, 31793383, 5887875, 12958724, 32781709, 26908279, 1819476, 27892679, 14042849, 21550952, 19659757, 29999426, 32143358, 29885612, 881295, 15141784, 22278070, 7518845, 21609056, 3674920, 5841701, 26650925, 9082503, 4711861, 3241211, 29257918, 14065536, 29487811, 22533546, 22828753, 18654727, 8862498, 13429210, 28769123, 22564658, 1510140, 14973196, 12454607, 7074611, 2993270, 29477746, 15142379, 31703853, 27070014, 18090565, 6085104, 1723394, 783518, 3838883, 14284470, 21056616, 12982952, 33048059, 17794674, 21143675, 11912681, 17667794, 24227152, 14793467, 19135730, 24714178, 2112025, 26323168, 17995305, 14218099, 28887704, 17246280, 12911527, 25635315, 26641822, 12159104, 19232145, 25405764, 9679620, 8520157, 10200635, 13386594, 16807165, 30208894, 21519182, 10885521, 29906828, 18728875, 13686245, 6789000, 12752248, 10266404, 12987434, 17045016, 13142536, 14623496, 2047181, 11574224, 29575027, 9218089, 13131236, 33531622, 3742212, 20069186, 3537277, 32735807, 28670356, 5927838, 17104559, 2027271, 14186952, 4414140, 26598063, 21302229, 28537366, 17892597, 33083560, 26477379, 24956678, 5902619, 30265503, 4506478, 4400084, 758114, 30348377, 15332543, 990944, 2496644, 7786224, 32754660, 29844810, 28787399, 2046933, 991814, 24876992, 8815338, 33057577, 11659903, 9617543, 3885566, 32543860, 22205929, 27947752, 30420884, 20911646, 29780618, 30863603, 723558, 9878880, 21827694, 17054273, 2953393, 30588715, 33074284, 10784971, 26185985, 13967024, 20452652, 14419883, 25090493, 7214341, 17508180, 696885, 7669499, 21904145, 11237463, 18158046, 16597103, 28567560, 14613040, 14544677, 14049287, 30058763, 2111826, 29064042, 19456264, 14426009, 16466989, 31251040, 30343614, 24122293, 4443024, 21679311, 1376594, 15089810, 24769818, 1581211, 1327924, 13714637, 26726163, 9467013, 31482712, 11897919, 16015490, 14877074, 12194850, 30691628, 7465644, 19422838, 2972233, 18297520, 1003506, 33487089, 17639110, 9258925, 7282416, 26395162, 18487266, 5990799, 15849944, 27495940, 31768474, 29728920, 13920410, 13542744, 6122607, 11651131, 33115797, 23320644, 24297732, 22807055, 24071613, 24649537, 6433907, 19157174, 32809907, 13853476, 28138935, 18739787, 33115168, 17442673, 6835523, 6313362, 16994833, 11169534, 22456751, 32795436, 1618773, 7932153, 12565333, 19258284, 17658656, 12281071, 25401184, 680523, 23242828, 24385763, 28714868, 29958908, 26712733, 24513098, 29508191, 8575481, 22008481, 27168634, 4374263, 29721545, 22549570, 23862565, 17008568, 11901738, 28811255, 30809756, 26378624, 21384360, 32340777, 14071941, 32736879, 28690978, 27108966, 3201658, 23188587, 13651784, 18200131, 13488917, 18561597, 10756715, 30450651, 18372751, 23092397, 20257300, 13940542, 25762618, 15737585, 14347134, 143016, 30733944, 5742899, 31251285, 2648031, 13667594, 5046860, 10013212, 22213267, 4937613, 17100325, 23321642, 8982010, 33352460, 18920311, 32582435, 29955464, 19916743, 6349730, 17311045, 17934538, 3380436, 23453475, 24910129, 13419811, 1689289, 18352368, 18723542, 31765059, 14766993, 3587207, 17592601, 14698625, 962895, 31016541, 7476450, 21854762, 693808, 1102302, 10986985, 17937920, 29544448, 32054750, 33344818, 9392131, 23037301, 7287971, 8522643, 4948781, 9192728, 7582184, 2386862, 14253301, 16904526, 23106286, 16511596, 26685377, 21860433, 16163079, 21738300, 26843032, 6228336, 25814459, 18480570, 23383138, 31645815, 15393644, 32669189, 26688397, 28319789, 3566675, 24024265, 22857453, 20217405, 6143261, 23766630, 1084191, 6758643, 23493590, 1935391, 4988952, 12814547, 29244169, 4360073, 22643602, 24837165, 29894140, 23792185, 23612930, 3708324, 28603514, 5320841, 23235402, 24811166, 12229390, 32417307, 1209022, 21704942, 20654716, 18639519, 21964944, 31989425, 25280742, 18250449, 24666979, 12609322, 32241870, 24527038, 10695557, 28337548, 31100143, 11908949, 7772705, 24417918, 17932000, 8754926, 10961548, 18589405, 3173756, 8496243, 3993861, 25321607, 5834910, 45715, 20207920, 20623444, 16204304, 6696750, 18052313, 22209768, 586166, 16076343, 9772570, 20069938, 29428655, 18593279, 13175649, 7778874, 24863725, 2150899, 24374254, 14636166, 2057568, 20271131, 13474983, 12200060, 31570176, 26638498, 7768828, 5416114, 13617244, 29553219, 20222719, 18370590, 28555120, 938611, 20784732, 29244997, 17105703, 23073612, 14752279, 24491014, 8172513, 6745307, 32364638, 10360230, 1113324, 27148748, 13516728, 23276697, 16760556, 12778693, 15035490, 2470560, 3962292, 16264191, 22057315, 9281177, 24964134, 10289306, 11561381, 18369790, 20392768};
static const uint64_t root_inv[N] = {0, 4760932, 13499153, 21938565, 22785890, 14056826, 24285310, 27938338, 9426196, 31350138, 30352193, 10149685, 1140056, 649880, 27372525, 9550133, 501067, 5411869, 811870, 16892476, 4679760, 1529124, 16015129, 21620241, 27906268, 21100145, 3050639, 15265118, 21051562, 16195630, 18269605, 5343767, 31258325, 19464215, 23564159, 17473710, 21453362, 9795452, 22685269, 33505735, 31034804, 17941644, 23054283, 15379670, 8969567, 27482591, 15004011, 32675015, 9277376, 26566369, 10667325, 15991461, 11427911, 16642093, 9742026, 16367815, 8460173, 15102680, 24333065, 13756690, 13533911, 1466133, 10658623, 29624690, 33193998, 6229980, 8743221, 4457820, 8580918, 21156125, 189149, 28792776, 285227, 2264, 10420445, 32038148, 27761690, 7927855, 7592012, 21647366, 22029388, 7971751, 385782, 17461113, 16620023, 32579155, 31375729, 11964204, 8431289, 5167339, 4681025, 32237843, 33254929, 29392120, 24106179, 2951574, 2274807, 18520986, 16958068, 2305643, 15794395, 23199393, 2580934, 6583826, 13539352, 27143752, 7098522, 30855744, 2737166, 17606226, 20565648, 19233249, 23281995, 21783198, 20438788, 31955344, 6345790, 33276057, 13085226, 26591536, 3454840, 5168890, 22563580, 27689771, 1918505, 22360437, 26047052, 3762725, 2136874, 1295800, 21936528, 9297256, 24356853, 24689701, 17056149, 15482269, 23963075, 4264447, 9623777, 2294007, 26638771, 31719194, 10696307, 16874833, 22258062, 19322199, 11872764, 2432073, 27957418, 2474819, 12246672, 10867588, 26968946, 1222011, 27668148, 21579819, 32659557, 9853701, 31556495, 10204060, 26266384, 8436014, 46120, 12565260, 15120857, 32210258, 12241024, 9445200, 32424294, 26141027, 6554255, 30056502, 5276286, 25397512, 30230071, 26868776, 18535303, 3968231, 22751501, 23383299, 16739306, 5236813, 7170990, 1394219, 31218903, 31158593, 16967280, 23729319, 4955113, 5650247, 33001057, 14784739, 6811853, 10673769, 9595256, 24218356, 18074286, 26082996, 28057775, 30005931, 7347621, 18337996, 996257, 12408830, 26499615, 18249116, 25101513, 16054630, 6543554, 17785943, 9563220, 4840264, 11059881, 27412492, 16231856, 15966818, 23461689, 9488390, 27593250, 22153949, 6749048, 10657979, 25685226, 888583, 28150129, 9686871, 29512094, 13544313, 27760189, 2441259, 28022351, 26407211, 33199493, 13910465, 12941874, 4936482, 18797971, 13377401, 26381630, 24295961, 25154884, 8989918, 20997298, 10228345, 22819644, 21274321, 584182, 6218037, 2250785, 7291436, 3750223, 26357349, 23228604, 15631834, 24757834, 476468, 27103232, 17409935, 23065773, 25639170, 14067914, 17073448, 21836429, 11342109, 13018030, 23735377, 17400028, 29019843, 4204314, 3781432, 27031887, 10586309, 15471258, 676473, 1506700, 26834985, 24702360, 144673, 31315397, 28989968, 1695660, 17966719, 28227296, 12131533, 26851056, 2944543, 15925040, 28894743, 31982015, 10062639, 20121207, 10451469, 32716044, 1862938, 13551406, 20912686, 14992246, 8446155, 24537674, 25723429, 11880087, 3539705, 1612481, 28549647, 23961931, 6542516, 17975242, 20718781, 13741391, 18361575, 2721696, 27824225, 29315576, 217402, 15785021, 22216782, 17194389, 7431930, 25300437, 28989510, 21621832, 15393472, 10188049, 3640490, 22245425, 16068424, 1685820, 24422705, 21352058, 20779814, 28109023, 2328636, 28515730, 24370420, 15738410, 570024, 31720057, 119449, 456843, 24498347, 19883106, 3356213, 28360414, 1318100, 28461098, 16789763, 15714505, 6263912, 20086052, 30277421, 18857966, 1803048, 18252673, 15716316, 13930734, 21018738, 14150211, 20857567, 9265270, 25275907, 2670980, 11155165, 16848312, 24372499, 11698727, 1966301, 6092315, 19315156, 8832868, 351004, 13378817, 31171313, 19251588, 33214055, 19023430, 13914863, 21541863, 33485367, 25472159, 9459650, 19852725, 3997626, 21015200, 3379079, 24647086, 31322627, 9877017, 28717700, 10411491, 6640100, 16978629, 21336292, 20618128, 7168215, 26536315, 12854925, 9966747, 5646858, 29272670, 11224459, 32254363, 7938226, 25347358, 20633087, 21914507, 32003169, 25829275, 20129235, 28104505, 9507128, 20270578, 30414627, 15714828, 11691450, 23435244, 14257476, 13397802, 28705418, 1852225, 7474358, 15216486, 28802075, 32673332, 20284719, 8023242, 3507562, 13521987, 26501019, 13050395, 5535358, 21523234, 22924921, 7616371, 27425505, 16124054, 650954, 29565781, 571445, 8133929, 12873180, 973135, 25546971, 22608261, 15347664, 14762751, 4801314, 28047638, 1244806, 9587389, 19267029, 26020134, 4634714, 13387637, 21702191, 3884797, 24844678, 8320397, 28088627, 22969980, 7906406, 29824565, 13374470, 15365986, 13227710, 23513052, 24253195, 15203844, 22244281, 26131476, 10672440, 9717129, 30841006, 19083055, 26245800, 101879, 33474453, 22316223, 23776011, 33087027, 23366884, 29322979, 20639001, 3356728, 18477818, 21941067, 2575509, 1094514, 27815779, 3266891, 31233260, 13528156, 23278682, 16725013, 28273201, 5084728, 1724423, 13439294, 9311089, 15098420, 28294284, 21032205, 984803, 597342, 12858762, 17862617, 12338272, 13170509, 10645784, 13421251, 3507828, 29654265, 6317628, 32886136, 12384005, 11677859, 8211177, 10107753, 241497, 32155614, 29759447, 29490718, 26314296, 7604265, 26135043, 17425369, 19410641, 303849, 32777353, 31541215, 11773433, 7611636, 18700853, 33073741, 13985689, 14778324, 22385702, 8130239, 23681759, 29562205, 33031118, 23128911, 4140199, 4431832, 2770236, 21681963, 13167627, 6287094, 10795582, 26688098, 22970740, 6483567, 27936659, 17177866, 33090672, 6002009, 10686514, 32332854, 26398492, 8946140, 6827258, 18504814, 7053575, 33439116, 26949062, 11679055, 13454636, 32628219, 8852213, 13366221, 8040022, 15936647, 22527344, 19195314, 7494275, 15443080, 7694099, 20548269, 29469465, 25672393, 15738746, 10344706, 27101809, 30332817, 2513788, 28363420, 28354642, 21472696, 16517859, 15239474, 14347101, 15362888, 19338162, 31446076, 3472108, 15334264, 13460124, 1833820, 24152750, 23556607, 19373558, 11781376, 10211066, 16759426, 14675817, 1358517, 13538923, 4172887, 31199282, 29138682, 17494315, 25728749, 1703494, 21142487, 11127578, 30107156, 29535576, 4322796, 30911110, 10756866, 22360251, 26394898, 28492755, 8605391, 15035021, 27932876, 16681000, 15035070, 3643793, 1244405, 22343206, 19574092, 13211944, 10643477, 32510896, 12264247, 16077771, 4122364, 1153940, 31057786, 12941982, 4919512, 12580535, 24933816, 11292825, 30994682, 3227743, 28958025, 4051197, 14153053, 26753162, 24942416, 24198552, 24386421, 30330258, 23151283, 32204600, 9409139, 26222886, 5156798, 17926086, 31140881, 532074, 28683619, 28515274, 26716208, 11278860, 4394365, 31423237, 22652040, 4156528, 15733530, 30230169, 24739821, 14497321, 19586837, 14021788, 13375787, 8405682, 30975599, 14745607, 26096847, 29157686, 7106112, 13806036, 31508653, 27286384, 26130154, 2688511, 24871700, 10286270, 13346792, 5641928, 2019285, 20748456, 11192717, 24844342, 11590135, 1420827, 16858138, 28795462, 31370992, 28758214, 15515122, 12103323, 18097169, 9344297, 14299941, 23066728, 30730068, 29777656, 1702036, 24039488, 3123009, 28405899, 13692421, 1324357, 20979086, 13530455, 22873233, 17353422, 30671156, 12185043, 4299758, 12325894, 7294260, 32010746, 28264798, 6606665, 2771696, 20932280, 31319174, 15280713, 21937533, 2398335, 15221300, 2499351, 14740022, 2522585, 14228086, 14736534, 23855996, 23845282, 9139059, 10575085, 16251182, 24112862, 15778554, 2981339, 3629037, 10712259, 12805977, 11224555, 32888306, 3663760, 16541372, 9041292, 23545155, 27514535, 31386928, 11101618, 12987562, 27277466, 27377121, 13653933, 18971397, 26116230, 13952903, 22301046, 18270986, 32184918, 4618322, 5683097, 13324982, 20155960, 520894, 29247449, 16523626, 4904805, 27342415, 8097556, 30744783, 23907843, 2291270, 20314690, 10396611, 4128297, 7593352, 1265359, 4007127, 4661362, 7836185, 21812923, 17687329, 3835169, 32681625, 24915634, 30313696, 29181512, 33397334, 22461974, 11092702, 28716175, 133679, 10973994, 22848718, 22561036, 20198230, 4971260, 8041576, 20432909, 3499053, 25784042, 32052500, 18950726, 7792982, 31153206, 27448158, 24962078, 1065568, 3750872, 26621020, 24278688, 2591432, 25622629, 6393305, 28253182, 31837142, 3255250, 26939426, 20589969, 24741869, 19099956, 9028007, 28418776, 31571387, 27355576, 14180869, 8666852, 32800522, 24325856, 15428709, 19448195, 12840000, 8316385, 16237494, 10781168, 1210667, 12278437, 28483115, 11570837, 32854880, 5177822, 25592194, 16047115, 25375686, 12085020, 2195815, 17921521, 2381258, 26819813, 23595166, 14471297, 13617282, 23816591, 17385683, 10984366, 26603773, 27800062, 29422420, 26649696, 32208994, 8511767, 3688272, 182073, 16853736, 32106386, 24196847, 22648900, 17972405, 18127205, 23627743, 8870403, 23348680, 2341783, 18546742, 27497209, 33531156, 20569833, 31333845, 465735, 10229146, 25181693, 12282950, 21857159, 19588886, 5865092, 17075748, 29565998, 3818977, 11975314, 10041877, 30887929, 19547255, 20638569, 28652706, 6402368, 3305, 3184654, 7467013, 9342729, 32216069, 20201809, 16715935, 8166358, 5487300, 8919791, 7376661, 17287584, 5784323, 6665361, 22704593, 69767, 18998439, 19953036, 28981153, 15008081, 3547377, 31966184, 12959517, 14820919, 6497832, 26658169, 4864272, 12545279, 18321418, 15517249, 11874006, 24652372, 30021856, 27537596, 5837154, 11820304, 9548900, 3324882, 3695848, 27561651, 30524797, 9803115, 27726576, 7876291, 8609589, 31251672, 17230245, 1254926, 10361195, 32656277, 2872839, 17629652, 8975864, 1482062, 2641861, 13682616, 13135527, 3879378, 28418444, 33277760, 30600415, 15303003, 9069963, 27104512, 8349173, 6917562, 29920048, 27560078, 13578317, 8705003, 24626663, 29672161, 26674569, 27475974, 25691412, 15609978, 12246331, 255649, 29460553, 22067847, 31294067, 25186454, 1940808, 24959578, 15936808, 14845610, 29074631, 12745213, 5692238, 16858756, 17317983, 30716664, 27780272, 14270792, 17746031, 16860332, 3638786, 24643936, 6797722, 13269092, 30785256, 22291384, 14655377, 30747050, 31153522, 19849199, 12854518, 33309841, 9128816, 25839903, 12482300, 921290, 32701496, 24146042, 15680667, 30769774, 9782642, 1885221, 13157569, 15180547, 21988956, 23261031, 8586203, 24269160, 11493022, 17286146, 29588045, 31079777, 18514847, 20771644, 16789781, 10273640, 20033609, 6401589, 32437013, 23190107, 1185699, 26805030, 25377824, 9059323, 18798058, 10476725, 16444634, 4305340, 12765605, 32611726, 4995217, 15179747, 13327618, 3997118, 19933093, 28134223, 25781509, 6911839, 1980161, 21350277, 20075354, 13279206, 31492769, 18914171, 9176083, 31399438, 8686612, 25771463, 20374688, 14957058, 4121682, 13480399, 23777767, 17473994, 32964171, 11340569, 15498024, 26853587, 17346033, 12926893, 13342417, 33504622, 27715427, 8228730, 29556476, 25054094, 30376581, 14960932, 22588789, 24795411, 15618337, 9132419, 25777632, 21641388, 2450194, 5212789, 22854780, 9023299, 1308467, 20941015, 8883358, 15299888, 8269595, 1560912, 11585393, 14910818, 12895621, 11845395, 32341315, 1133030, 21320947, 8739171, 10314935, 28229496, 4946823, 29842013, 9937407, 9758152, 3656197, 8713172, 10906735, 29190264, 4306168, 20735790, 28561385, 31614946, 10056747, 26791694, 32466146, 9783707, 27407076, 13332932, 10692884, 9526072, 29983662, 5230548, 6861940, 881148, 18156693, 1904522, 10167199, 15069767, 7735878, 27322001, 6707305, 11812037, 17387258, 11689904, 6864960, 17038741, 10444051, 16645811, 19297036, 31163475, 25968153, 24357609, 28601556, 25027694, 26262366, 10513036, 24158206, 205519, 1495587, 4005889, 15612417, 22563352, 32448035, 32856529, 11695575, 26073887, 2533796, 32587442, 18851712, 15957736, 29963130, 18783344, 1785278, 14826795, 15197969, 31861048, 20130526, 8640208, 10096862, 30169901, 15615799, 16239292, 27200607, 13633594, 3594873, 967902, 14630026, 197877, 24568327, 10228695, 16450012, 28612724, 11337070, 23537125, 28503477, 19882743, 30902306, 2299052, 27807438, 2816393, 33407321, 19203203, 17812752, 7787719, 19609795, 13293037, 10457940, 15177586, 3099686, 22793622, 14988740, 20061420, 15350206, 19898553, 10361750, 30348679, 6441371, 4859359, 813458, 19478396, 1209560, 12165977, 7171713, 2740581, 4739082, 21648599, 16541769, 9687772, 11000767, 3828792, 29176074, 6381703, 11541856, 24974856, 4042146, 9037239, 6837604, 3591429, 4835469, 9164574, 10307509, 32869814, 8149153, 21269266, 15891681, 14292053, 20985004, 25618184, 31931564, 754901, 11093586, 22380803, 16555504, 27236975, 26714814, 16107664, 435169, 14810550, 5411402, 19696861, 740430, 14393163, 27116430, 8900800, 9478724, 10743282, 9252605, 10229693, 434540, 21899206, 27427730, 20007593, 19629927, 3821417, 1781863, 6054397, 17700393, 27559538, 15063071, 7155175, 26267921, 24291412, 15911227, 63248, 32546831, 15252817, 30578104, 14127499, 26084693, 2858709, 21355487, 18673263, 17534847, 21652418, 2067625, 24083324, 6824174, 19835700, 32222413, 31969126, 8780519, 18460527, 32173743, 11871026, 29107313, 9428044, 3206723, 2299297, 17083348, 19124328, 14094073, 4486295, 31438511, 3491574, 19501050, 19005660, 18937297, 4982777, 16953234, 15392291, 22312874, 11646192, 25880838, 32853452, 16042157, 26335996, 8459844, 19130454, 13097685, 19583313, 7364352, 22765366, 476053, 2961622, 30596944, 16496064, 11722643, 23671457, 32826779, 2686734, 3769719, 12638691, 3129453, 5602585, 11344408, 1006477, 29664771, 23932794, 21890434, 492760, 24734999, 8673345, 32558523, 31503404, 4762938, 3705527, 795677, 25764113, 31053693, 32559393, 18217794, 3201960, 32792223, 29150253, 29043859, 3284834, 27647718, 8593659, 7072958, 466777, 15657740, 5012971, 12248108, 6952274, 29136197, 19363385, 31523066, 16445778, 27622499, 4879981, 814530, 30013060, 13481151, 29808125, 18715, 20419101, 24332248, 3975310, 21976113, 31503156, 18926841, 20407801, 16505321, 20562903, 23283933, 20798089, 26761337, 19864092, 14821462, 3643509, 22664816, 12031155, 3341443, 16743172, 20163743, 23349702, 25030180, 23870717, 8144573, 14318192, 21391233, 6908515, 7915022, 20638810, 16304057, 4662633, 19332238, 15555032, 7227169, 31438312, 8836159, 14414607, 18756870, 9323185, 15882543, 21637656, 12406662, 15755663, 502278, 20567385, 12493721, 19265867, 29711454, 32766819, 31826943, 27465233, 15459772, 6480323, 1846484, 18407958, 4072591, 30557067, 26475726, 21095730, 18577141, 32040197, 10985679, 4781214, 20121127, 24687839, 14895610, 10721584, 11016791, 4062526, 19484801, 4292419, 30309126, 28838476, 24467834, 6899412, 27708636, 29875417, 11941281, 26031492, 11272267, 18408553, 32669042, 3664725, 1406979, 3550911, 13890580, 11999385, 19507488, 5657658, 31730861, 6642058, 768628, 20591613, 27662462, 1756954, 24254981, 2550942, 30321978, 6413383, 5607336, 2747925, 33378335, 2256481, 5787081, 10733976, 29117317, 24113005, 26469235, 6131198, 14540711, 29099600, 14174651, 33190342, 20156459, 27883216, 13961728, 16135943, 3918331, 20886685, 8639897, 22631986, 27874292, 7819944, 22511466, 33336502, 3567400, 4147489, 5353741, 10141579, 27599104, 12080437, 14321581, 30417398, 13789743, 2785819, 7532951, 26376200, 10858574, 23358063, 10220631, 1343615, 19235523, 19307500, 25767368, 2899124, 9819737, 22656172, 7460071, 11728851, 17110356, 10624007, 7140516, 14391620, 8997328, 6602409, 8746657, 13686963, 10263219, 21763376, 25083938, 10844447, 23715449, 10476352, 5104850, 19195102, 31093938, 21191083, 22531139, 9088836, 18286082, 29808859, 11488278, 22744462, 12245332, 31249595, 6274377, 21778177, 32703552, 27325040, 19227733, 4847459, 30615672, 5245210, 23516935, 68334, 31186527, 21959568, 10020982, 12581035, 25192571, 25062742, 3219803, 23176392, 15519876, 13253045, 19684901, 9254682, 26159125, 9723176, 29616117, 987420, 3229003, 29960355, 28520551, 9403390, 26671070, 16876596, 31431298, 7971686, 24604817, 267054, 22920136, 3812598, 9091828, 15384352, 32230009, 5464106, 6081712, 31542965, 4439616, 26685589, 6228414, 19018170, 14306313, 13076147, 28117392, 10210168, 9217846, 9911119, 26683353, 7638050, 5666560, 31919369, 7025309, 4172819, 10351901, 17437296, 31931324, 9913674, 9773909, 8453667, 28608852, 1583556, 2768514, 25215752, 13030337, 10225920, 9994886, 26538423, 30441867, 30594639, 8828015, 21012582, 28791103, 8157282, 25657110, 22035775, 26256966, 32058575, 19940557, 8344045, 7482402, 26120431, 22782011, 20754700, 5501195, 31546591, 30109244, 27020026, 29055444, 9220021, 28599548, 13306874, 5858032, 12183466, 33273933, 19351295, 30546682, 11299031, 10824922, 23151949, 8264564, 11960492, 4468668, 6724553, 12602028, 32784280, 19002619, 30985286, 20145592, 19990372, 15781509, 9737022, 3757647, 13685356, 27702958, 8628915, 27555715, 12582359, 20525424, 31058304, 17439605, 19099043, 9111576, 7146634, 14091764, 8585688, 15301626, 25722458, 5011591, 11842452, 24886288, 14435318, 33091094, 33539046, 9189486, 24153734, 30217621, 19694031, 29652795, 7895815, 14200354, 1099487, 25372728, 10056993, 14162755, 2916993, 32184622, 853246, 5654086, 29015535, 27084074, 12917851, 8942059, 7534045, 19091807, 12102424, 4854717, 6028326, 6105558, 6991855, 10101515, 11548911, 1971583, 29692301, 17897216, 7579249, 26382368, 2004043, 16720732, 31020576, 1349649, 31549867, 17669815, 25513883, 21350907, 11722189, 1082944, 31792649, 31376130, 28674034, 25080505, 30437985, 6910728, 25143355, 13297528, 15760617, 12367444, 7922466, 25242059, 8632554, 15926619, 12113294, 13309066, 17478295, 15004590, 26096506, 26668001, 22020156, 15446381, 28365740, 21019198, 21636318, 20503105, 31306437, 12889617, 23449348, 13411660, 20172410, 20851315, 8036152, 6749003, 14472145, 11615486, 31970000, 23443333, 4865629, 27775498, 33455331, 13306868, 14406101, 15899746, 9171117, 23188220, 22379292, 17864399, 22338916, 806695, 19367185, 12889515, 16437967, 2484051, 6682334, 20405227, 11361567, 30966115, 8175252, 32737006, 4053080, 884014, 28313081, 32854695, 17130467, 9842022, 20070912, 22315500, 22429649, 34421, 18529316, 2860550, 2773173, 30150703, 26079576, 6806273, 13925635, 1881985, 12497964, 7485493, 8674285, 10862775, 1296721, 1855255, 30239989, 31631160, 30124397, 32109925, 20177794, 13968472, 23822084, 17103350, 24399225, 26905816, 21297345, 502539, 11865357, 30889416, 6323668, 30953081, 4274997, 27387953, 31968981, 879452, 26546408, 25801813, 17157529, 10345608, 25950838, 26974002, 7342526, 17775915, 16592733, 5432796, 12111279, 13265308, 29126176, 24107509, 9511866, 25856889, 29602175, 30719469, 24518478, 6115397, 13295200, 11830492, 9654493, 25266089, 18438467, 12887438, 12802224, 32447258, 15956964, 4434552, 21988711, 7029852, 13514422, 2027102, 26209930, 23539604, 29799509, 6716109, 5190189, 31735548, 23908532, 1950394, 4990977, 30451097, 23652379, 1684982, 14184580, 13898315, 23665554, 3834356, 22144978, 1940389, 3065347, 2953617, 10742774, 25514509, 13519522, 32080379, 2234651, 19780561, 12911282, 29441217, 7313765, 33531347, 32712213, 265586, 18555382, 22468533, 19791789, 27352741, 7419049, 12971428, 21455988, 31662726, 7327399, 15047187, 32333299, 9313850, 19452002, 19280893, 5974628, 30821736, 5721705, 774473, 24701069, 21365569, 11090179, 18240785, 17569667, 768730, 27602994, 21593003, 8252003, 4651469, 7686662, 28392136, 1085686, 13258575, 15288742, 20797182, 8113356, 24989714, 3272533, 3623923, 6525528, 14888046, 31532056, 7886667, 4635107, 28470586, 5873131, 17684200, 2880838, 4348055, 27506603, 12565976, 23514885, 29389954, 25079003, 22444309, 2571152, 5003090, 10675762, 25662568, 32106789, 12010172, 8238634, 9073088, 11995493, 11255919, 25506612, 9464972, 8800684, 23658110, 19107939, 14813081, 14672601, 25046986, 10757698, 9557163, 21682020, 31004577, 33115966, 15398241, 22990284, 22817093, 26500812, 5680393, 6866266, 4518871, 26614701, 29263039, 1456889, 13576397, 14874513, 19818174, 214827, 10972196, 26263288, 24356151, 23800084, 16843358, 25263365, 28597834, 7980484, 17685462, 4766876, 22077014, 29327626, 20174987, 18672950, 28519611, 25704221, 26616701, 8625586, 19426094, 21513574, 27568435, 30422445, 4755041, 12480423, 26742884, 11533969, 2437508, 23260167, 3142275, 30454052, 20245237, 6473492, 32938656, 26751123, 9312529, 32259079, 22708923, 9571576};

/* Cooley-Tukey NTT */
void ntt(POLY_64 *a)
{
	uint64_t t = N >> 1;
	uint64_t m, i, j;
	uint64_t j1, j2;
	
	uint64_t x, u;
	
	for (j = 0; j < t; j++)
	{
		x = montgomery(con_add(a->poly[j], Q), MONTGOMERY_CONVERT_FACTOR);
		u = montgomery(con_add(a->poly[j + t], Q), root[1]);
		a->poly[j] = con_sub(x + u, Q);
		a->poly[j + t] = con_add(x - u, Q);
	}
	
	for (m = 2; m < (N >> 1); m <<= 1)
	{
		t >>= 1;
		for (i = 0; i < m; i++)
		{
			j1 = (i * t) << 1;
			j2 = j1 + t - 1;
			
			for (j = j1; j <= j2; j++)
			{
				x = a->poly[j];
				u = montgomery(a->poly[j + t], root[m + i]);
				a->poly[j] = con_sub(x + u, Q);
				a->poly[j + t] = con_add(x - u, Q);
			}
		}
	}

	for (i = 0; i < m; i++)
	{
		j = i << 1;
		
		x = a->poly[j];
		u = montgomery(a->poly[j + 1], root[m + i]);
		a->poly[j] = con_sub(x + u, Q);
		a->poly[j + 1] = con_add(x - u, Q);
	}
}

/* Gentleman-Sande INTT */
void intt(POLY_64 *a)
{
	uint64_t t = 2;
	uint64_t m, i, j;
	uint64_t j1, j2;
	uint64_t h = N >> 1;

	uint64_t x, y;
	
	for (i = 0; i < h; i++)
	{
		j = i << 1;
		
		x = con_sub(a->poly[j] + a->poly[j + 1], Q);
		y = con_add(a->poly[j] - a->poly[j + 1], Q);
		a->poly[j] = x;
		a->poly[j + 1] = montgomery(y, root_inv[h + i]);
	}
	
	for (m = N >> 1; m > 2; m >>= 1)
	{
		j1 = 0;
		h >>= 1;

		for (i = 0; i < h; i++)
		{
			j2 = j1 + t - 1;
			
			for (j = j1; j <= j2; j++)
			{
				x = con_sub(a->poly[j] + a->poly[j + t], Q);
				y = con_add(a->poly[j] - a->poly[j + t], Q);
				a->poly[j] = x;
				a->poly[j + t] = montgomery(y, root_inv[h + i]);
			}
			j1 += t << 1;
		}
		t <<= 1;
	}

	for (j = 0; j < t; j++)
	{
		x = con_sub(a->poly[j] + a->poly[j + t], Q);
		y = con_add(a->poly[j] - a->poly[j + t], Q);
		a->poly[j] = montgomery(x, inv_n);
		a->poly[j + t] = montgomery(y, root_inv[1]);
	}
}
