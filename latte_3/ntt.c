#include <stdint.h>
#include "ntt.h"
#include "param.h"
#include "poly.h"
#include "red.h"

static const uint64_t inv_n = 68651320321LL;

static const uint64_t root[N] = {0, 1999702476LL, 13878496949LL, 13876924087LL, 18564619791LL, 16486114052LL, 58012629646LL, 34093406695LL, 15915230133LL, 10783352259LL, 56919179419LL, 27193134755LL, 14437253308LL, 54100911841LL, 15860489127LL, 20372686739LL, 31466018908LL, 54765268746LL, 6175382141LL, 32117933588LL, 7942468117LL, 60698460390LL, 31296338340LL, 16336907288LL, 34881420784LL, 12386723184LL, 64136512936LL, 5137543882LL, 11135105355LL, 1374614434LL, 57332912135LL, 15384865910LL, 58899336706LL, 4697585372LL, 9380411922LL, 20156587536LL, 50355112929LL, 27192307021LL, 12704606449LL, 4556383086LL, 50638465521LL, 2514740496LL, 52525986007LL, 34591194405LL, 35618066456LL, 18052992076LL, 2763722849LL, 42263978419LL, 35063209163LL, 44014871800LL, 2240830185LL, 26928616701LL, 55546280373LL, 65933207919LL, 23137116867LL, 43045489374LL, 43894200396LL, 11518857524LL, 55461922600LL, 42442667675LL, 33993444009LL, 26308017312LL, 31906567246LL, 59127931057LL, 39107284174LL, 53835433319LL, 54584699730LL, 1145748827LL, 57198293235LL, 31087790612LL, 44796958985LL, 818524427LL, 51186849003LL, 48922520369LL, 66524539804LL, 9138269123LL, 56442491703LL, 52892377836LL, 57927556604LL, 48199223210LL, 41453592548LL, 26843359053LL, 15580837840LL, 29174758101LL, 41479820765LL, 33333304004LL, 59168214654LL, 60272848798LL, 33931282109LL, 18515688752LL, 25004782316LL, 12650175756LL, 49206465128LL, 16669403550LL, 28545797260LL, 40636462468LL, 837994574LL, 36832752009LL, 54702187510LL, 27492348256LL, 7625709615LL, 37477381036LL, 67886667702LL, 5462078842LL, 28808404597LL, 12115702152LL, 31128958804LL, 40040891610LL, 62566540863LL, 36333874494LL, 21237058667LL, 1622272272LL, 16076402679LL, 994930784LL, 46822103241LL, 63154651257LL, 49806251750LL, 59063381416LL, 49085680570LL, 12049303736LL, 3023027964LL, 68692473265LL, 22887617288LL, 21804700414LL, 3857269333LL, 21323298507LL, 5995587428LL, 12507306530LL, 2976053421LL, 34486975550LL, 54407659608LL, 19260227562LL, 20931806933LL, 15383235338LL, 51772211093LL, 26214797108LL, 41216543976LL, 66633925502LL, 60370170763LL, 22999563780LL, 2598768422LL, 38181577417LL, 27746010556LL, 32090807511LL, 2344554962LL, 26228690392LL, 24798247758LL, 67496314601LL, 27063864836LL, 19037537762LL, 49318024816LL, 4539285536LL, 7653944776LL, 63793177678LL, 47127271378LL, 52788978434LL, 50683213693LL, 49002176967LL, 46568752375LL, 21292002988LL, 32083418996LL, 10197738455LL, 22995276946LL, 38841939601LL, 62578166236LL, 21385508037LL, 30914180040LL, 18634577695LL, 22480078948LL, 36313922761LL, 22070714068LL, 43588562144LL, 52759229003LL, 28121775091LL, 59731086408LL, 43384973514LL, 21719291966LL, 40624892457LL, 58646317544LL, 62475241366LL, 38257734888LL, 31257862532LL, 39459020296LL, 5187467903LL, 5723707594LL, 21562049890LL, 13159556275LL, 10413290826LL, 15017096921LL, 26135496402LL, 49759241656LL, 28374099843LL, 15035032882LL, 25651286095LL, 65011791468LL, 22498277134LL, 28540520597LL, 41262197389LL, 56456803520LL, 60793063033LL, 23514482312LL, 22504622286LL, 18586288225LL, 55407295060LL, 59028704637LL, 14511573755LL, 5443076360LL, 36552237575LL, 2444642064LL, 447200223LL, 34804079477LL, 52295587499LL, 31194309227LL, 34440149957LL, 3922945908LL, 29530231822LL, 35295359602LL, 37380105990LL, 7386735627LL, 62596002636LL, 31419166834LL, 66883870085LL, 48291988799LL, 26551537505LL, 33568088614LL, 6859627440LL, 4513862122LL, 60943326998LL, 59195798332LL, 56676928816LL, 52910102257LL, 7191637187LL, 13575691207LL, 18948016971LL, 63854486894LL, 61338641953LL, 11966381958LL, 22951010074LL, 50519068727LL, 56069297360LL, 57121706365LL, 32740839705LL, 28475993673LL, 5188123131LL, 13488904443LL, 65489789022LL, 38402724876LL, 38983104157LL, 22774872550LL, 39447956393LL, 13084139735LL, 38016271358LL, 10583188739LL, 3922796351LL, 7152013785LL, 51292441467LL, 27854613834LL, 41093566755LL, 31704829840LL, 19338833462LL, 58559680000LL, 332148465LL, 43087797670LL, 21880690241LL, 25300206504LL, 28982194210LL, 11495260745LL, 57432847432LL, 49761045169LL, 37826275500LL, 9122398365LL, 2345133749LL, 57537192999LL, 19028064664LL, 45876369564LL, 61917200955LL, 42890002119LL, 49793964100LL, 2705704033LL, 6296479840LL, 312513072LL, 16082904739LL, 19546584885LL, 59253434241LL, 46003466830LL, 63772120524LL, 67069274054LL, 4617715637LL, 40425689223LL, 39724869877LL, 65874244792LL, 34128078701LL, 45364323787LL, 39894780032LL, 13179463703LL, 20676436412LL, 24091988312LL, 42509423348LL, 12826356431LL, 922270411LL, 33185606416LL, 24032074105LL, 19838912522LL, 34536762135LL, 63779030988LL, 54582017167LL, 1592735158LL, 63804457718LL, 5882684512LL, 14234091577LL, 6260420940LL, 5063574218LL, 48844923165LL, 43321871969LL, 15464669245LL, 50934218970LL, 26268352847LL, 49803162323LL, 29200091928LL, 3704406396LL, 45407342207LL, 29649541738LL, 57683661983LL, 18996465272LL, 68157646178LL, 26934664110LL, 35468333630LL, 335765964LL, 59515148838LL, 27492058389LL, 64487541653LL, 30011056605LL, 32438882832LL, 55028591373LL, 8506132939LL, 27573644230LL, 26368452694LL, 53827539856LL, 50259380583LL, 6932473215LL, 12113944239LL, 34574494100LL, 68402774033LL, 27257774202LL, 61032611267LL, 37480428884LL, 52661240869LL, 10437018058LL, 26128295785LL, 65698173736LL, 49873942908LL, 23879163730LL, 23797046231LL, 21942936458LL, 16587966502LL, 1211402213LL, 35092830530LL, 50082930295LL, 16405208069LL, 9955246615LL, 12689626989LL, 37138052586LL, 65946090692LL, 48143808846LL, 14801445417LL, 43515365966LL, 25133686060LL, 346796459LL, 7889366119LL, 41176519889LL, 6284194761LL, 7507197210LL, 1319700783LL, 39658956828LL, 67507944764LL, 38340651978LL, 24563304339LL, 41917416413LL, 35884305206LL, 49622321425LL, 19626207842LL, 13067271237LL, 31416704717LL, 2573996916LL, 59445454216LL, 305990872LL, 12903678325LL, 35316781059LL, 31768659117LL, 48658245582LL, 50653305226LL, 48210047001LL, 22570562406LL, 2780658686LL, 19886772326LL, 29168049352LL, 5812930485LL, 64817820604LL, 67578704139LL, 56328236122LL, 30754691724LL, 67763520562LL, 48012704618LL, 19400463356LL, 52971625705LL, 34919685326LL, 58624125691LL, 49762095092LL, 65719147392LL, 67485262483LL, 51492740753LL, 23908611528LL, 5465283067LL, 63714102066LL, 700030357LL, 20612407435LL, 52804210935LL, 8186863020LL, 59869970338LL, 66126527316LL, 51190864961LL, 11136399695LL, 39886688115LL, 3260920382LL, 13608770333LL, 23167779480LL, 29662305552LL, 33026678307LL, 60150998346LL, 2170154793LL, 19196411331LL, 32285810486LL, 56508860061LL, 35123372714LL, 46722366577LL, 23682778233LL, 5525548625LL, 56201111429LL, 28266901653LL, 5780882261LL, 29465505537LL, 12822856871LL, 31080768022LL, 28360248553LL, 9750149706LL, 58614614407LL, 43678029089LL, 58133718311LL, 33731020805LL, 51214537314LL, 3509518381LL, 49665565293LL, 68537095809LL, 4942945444LL, 35991298002LL, 42935072860LL, 18282116012LL, 20337162469LL, 774558613LL, 66065642904LL, 43867946298LL, 11964911879LL, 38445335229LL, 6924795362LL, 47946983554LL, 24141290421LL, 41679922947LL, 7948804828LL, 56587864362LL, 6820266418LL, 63993450562LL, 50297831692LL, 40966564667LL, 57375602574LL, 3683531257LL, 14443512640LL, 60697763068LL, 67425112817LL, 19365824807LL, 37855289882LL, 20444879695LL, 27485256118LL, 55702894937LL, 56921678335LL, 16630543586LL, 65304622267LL, 43917392373LL, 19863906155LL, 44542321138LL, 64678447822LL, 4894636606LL, 15710379643LL, 44968739306LL, 68329857316LL, 57631739010LL, 57351222802LL, 5229649772LL, 14415724289LL, 54425287568LL, 8019009222LL, 47669318460LL, 11206455412LL, 17436220900LL, 32186543953LL, 18476672819LL, 32286303869LL, 36480123360LL, 18398599741LL, 3387988724LL, 5790212463LL, 19827659471LL, 39114556214LL, 55739538362LL, 67976961962LL, 50357488949LL, 39365498306LL, 68666282098LL, 6716507397LL, 13207621474LL, 24739932042LL, 56096696585LL, 3962870805LL, 1455534095LL, 37510690694LL, 10139908714LL, 49270317345LL, 14335612444LL, 31095833541LL, 16196093671LL, 39743427070LL, 42397319130LL, 33954977974LL, 40447653934LL, 23261062528LL, 51958095772LL, 20911236069LL, 47795723644LL, 21208329447LL, 45337057389LL, 55496797760LL, 37006130467LL, 53196382583LL, 47057211753LL, 27220099803LL, 29385213193LL, 52725958407LL, 62332879244LL, 30929729481LL, 63931972336LL, 22303151765LL, 43597065947LL, 57030566645LL, 41559619160LL, 20324562255LL, 31078933679LL, 43536844960LL, 5944666178LL, 49219781871LL, 55234947208LL, 26330078952LL, 1251435290LL, 39653442761LL, 24461627054LL, 33064662633LL, 3554345052LL, 67091678808LL, 58805136840LL, 13318701922LL, 27562545219LL, 29086526242LL, 60835343647LL, 27151347060LL, 52763998781LL, 57092504965LL, 13159873305LL, 64969091072LL, 68182622538LL, 2150571970LL, 18985832226LL, 43005021503LL, 32738601322LL, 6753921442LL, 60782436201LL, 17392897041LL, 43089161101LL, 29678872828LL, 15045365740LL, 27529283427LL, 43408543670LL, 40883810251LL, 61369576951LL, 42264256546LL, 49035506411LL, 23854715217LL, 41157993680LL, 54478505847LL, 31929660110LL, 31654307612LL, 24049010557LL, 3462869092LL, 17823822681LL, 17748882538LL, 31651701602LL, 67854265057LL, 47291319078LL, 39138124700LL, 45897470613LL, 50980199447LL, 17674106427LL, 65670959868LL, 54413388184LL, 68219209431LL, 3682646396LL, 54656627299LL, 20683624316LL, 8289892340LL, 45896048647LL, 41597276865LL, 43779089966LL, 45854744724LL, 37365194265LL, 13565845596LL, 24005947843LL, 62185527977LL, 45610120928LL, 63691031402LL, 51913189787LL, 33821619338LL, 34648499182LL, 17848617514LL, 6368490145LL, 66893357750LL, 51156833171LL, 42423735227LL, 30575927066LL, 34727897665LL, 64070285464LL, 27008431533LL, 59505115634LL, 13933544779LL, 20073632965LL, 9074745850LL, 18824653398LL, 22487516822LL, 41132256469LL, 40960301812LL, 52803231117LL, 61137761014LL, 27484766765LL, 48836887264LL, 40287309795LL, 49378474705LL, 26475044116LL, 54399864197LL, 64277385865LL, 9593327580LL, 52857745842LL, 13267153823LL, 45791753617LL, 68258638772LL, 37921995614LL, 59536215888LL, 50453526275LL, 34805519867LL, 182698418LL, 35410369920LL, 27134003380LL, 12780021398LL, 46890217252LL, 7087313208LL, 11964946247LL, 16524173468LL, 19539483436LL, 28989586102LL, 17704891798LL, 6153343125LL, 8193444066LL, 40095486266LL, 28840172454LL, 64022615784LL, 4856612154LL, 36782763266LL, 46668763593LL, 60530944752LL, 10368179664LL, 11670560576LL, 25238202511LL, 14511785931LL, 68044386313LL, 33865985523LL, 10043749709LL, 10485993152LL, 16582988399LL, 38917262674LL, 47786080138LL, 63515559983LL, 35519674673LL, 51237959894LL, 48646397857LL, 32090019910LL, 27630118886LL, 62386527576LL, 44840446576LL, 57759350866LL, 34914331969LL, 13098720927LL, 57266990091LL, 4905302597LL, 18079140388LL, 33077443828LL, 23965232224LL, 39636701644LL, 47901460979LL, 46896129743LL, 23504429187LL, 32273622797LL, 41201605829LL, 8353401733LL, 46808740846LL, 21783984751LL, 28565386763LL, 11234886436LL, 38837379182LL, 48963974110LL, 55721757348LL, 15824144862LL, 45303225089LL, 12008609765LL, 28735395953LL, 55390431128LL, 27865534775LL, 5976185273LL, 9750361031LL, 31089019360LL, 38027033737LL, 1238350891LL, 65219879304LL, 30096502637LL, 22300118137LL, 43111264912LL, 24093713765LL, 6305644371LL, 29371456310LL, 14839137884LL, 18134369749LL, 55346326608LL, 18979396946LL, 16976580124LL, 14358719711LL, 26112163462LL, 42340630591LL, 13645899520LL, 31528969865LL, 41803801730LL, 65264033693LL, 52936112507LL, 36771907049LL, 9261496648LL, 19763853525LL, 24555541322LL, 66133376620LL, 4873652787LL, 46735297446LL, 50265424690LL, 49359655811LL, 15858850296LL, 22729701682LL, 55840855276LL, 44899179218LL, 26853662872LL, 10771008918LL, 14967084146LL, 26555537617LL, 68310391830LL, 43482066130LL, 25296371268LL, 64231466478LL, 19063478359LL, 59701460683LL, 23140619228LL, 53592938799LL, 20393168587LL, 42400847443LL, 49624769423LL, 39681340045LL, 14003316965LL, 58723250818LL, 63684975171LL, 1038251863LL, 297843987LL, 5560523054LL, 46407472242LL, 6218403403LL, 19196674401LL, 41065792718LL, 8236915107LL, 15784659141LL, 48322429667LL, 50460738031LL, 51080121289LL, 39430915020LL, 68651530414LL, 52379517599LL, 5306707398LL, 48039668299LL, 55768919809LL, 3145284647LL, 66778476835LL, 61254464863LL, 15197629921LL, 42743301451LL, 37788895118LL, 26832817280LL, 55043870194LL, 43240954377LL, 31396940023LL, 1929130188LL, 25362587466LL, 47568195575LL, 63253730846LL, 33278200096LL, 24449571757LL, 17548272176LL, 51409315757LL, 5151336539LL, 998184976LL, 928193625LL, 31259018260LL, 61747588045LL, 13798541207LL, 19388176714LL, 22065652172LL, 62306374073LL, 20839290824LL, 8332805184LL, 2470951929LL, 9313653153LL, 34693171881LL, 847995045LL, 55316232308LL, 13299433874LL, 27925214959LL, 48207245529LL, 56811190237LL, 4537517657LL, 61023938477LL, 51134135281LL, 52415319190LL, 49937899509LL, 29110162125LL, 11668410477LL, 8293045201LL, 26365026749LL, 1008291060LL, 44500256687LL, 23462425508LL, 55614701588LL, 18834473151LL, 38071182555LL, 10197537017LL, 37003401234LL, 28830826953LL, 49359449189LL, 67560579845LL, 68053742793LL, 52958399737LL, 17177739149LL, 55778500707LL, 66419641030LL, 58259874975LL, 22081958036LL, 4402711592LL, 65746839039LL, 35514344598LL, 60274988741LL, 1467398977LL, 53491909718LL, 49786604133LL, 29512226108LL, 48869214637LL, 11578575979LL, 20120626403LL, 28604349102LL, 64538234507LL, 39306112473LL, 35180765418LL, 12290213127LL, 27371259395LL, 23464941722LL, 20833965486LL, 41127316592LL, 32178698347LL, 23958378739LL, 68028449680LL, 55626940355LL, 56968050274LL, 27346676321LL, 7433718167LL, 38532928210LL, 42628487219LL, 49443694215LL, 39296466079LL, 25683572701LL, 49589578945LL, 39332285580LL, 6902471412LL, 7893191610LL, 54267479654LL, 32762793678LL, 36048604041LL, 63930604378LL, 29092272277LL, 32962256297LL, 13535417871LL, 10239342790LL, 50038589899LL, 43102957327LL, 37121443138LL, 64712317961LL, 18325342401LL, 16520637655LL, 11924630406LL, 4048489088LL, 37742997362LL, 28460502226LL, 42381019953LL, 62615213827LL, 31015138365LL, 1288641317LL, 21288251041LL, 37781389738LL, 25858639681LL, 61733473768LL, 56854727500LL, 5587683376LL, 11867817731LL, 448562199LL, 46837524590LL, 19674026549LL, 61797808763LL, 37717031151LL, 63330457751LL, 56101548788LL, 22856031273LL, 40536821302LL, 33322274654LL, 37400259798LL, 28344584555LL, 56722168579LL, 18133931527LL, 8497753997LL, 68709906178LL, 42474446936LL, 48332178461LL, 27430322149LL, 52527196018LL, 35533780729LL, 33017627391LL, 59716704291LL, 43454131303LL, 55427209172LL, 22281290058LL, 52867019385LL, 60860500002LL, 46469302724LL, 60069926066LL, 35000487308LL, 27437337483LL, 7748810947LL, 36260429728LL, 3144092782LL, 63983226213LL, 64843024132LL, 62873190099LL, 16862108275LL, 42183552346LL, 44133590109LL, 10480954504LL, 46796865089LL, 46365734428LL, 37606728507LL, 48534523318LL, 9633894643LL, 22662723741LL, 63672779971LL, 47118714499LL, 38039928929LL, 52782263550LL, 35569359225LL, 14507956790LL, 32680623225LL, 49740750895LL, 60394364802LL, 40723361793LL, 39521792004LL, 57928819254LL, 48695604763LL, 64958731764LL, 28510665846LL, 37621734876LL, 41934979383LL, 30467633461LL, 22629439718LL, 19128837791LL, 67508624280LL, 38640670981LL, 40872732680LL, 55916749805LL, 31245141084LL, 25537273365LL, 9878277236LL, 11472986847LL, 32712160300LL, 4810097694LL, 58765869415LL, 2876239956LL, 40733569416LL, 22337301131LL, 67244126671LL, 49525757815LL, 29683804892LL, 58524037996LL, 11949752448LL, 39863226067LL};
static const uint64_t root_inv[N] = {0, 15434969410LL, 54841504074LL, 54839931212LL, 34625021466LL, 10705798515LL, 52232314109LL, 50153808370LL, 48345741422LL, 52857939034LL, 14617516320LL, 54281174853LL, 41525293406LL, 11799248742LL, 57935075902LL, 52803198028LL, 53333562251LL, 11385516026LL, 67343813727LL, 57583322806LL, 63580884279LL, 4581915225LL, 56331704977LL, 33837007377LL, 52381520873LL, 37422089821LL, 8019967771LL, 60775960044LL, 36600494573LL, 62543046020LL, 13953159415LL, 37252409253LL, 9590497104LL, 36811860915LL, 42410410849LL, 34724984152LL, 26275760486LL, 13256505561LL, 57199570637LL, 24824227765LL, 25672938787LL, 45581311294LL, 2785220242LL, 13172147788LL, 41789811460LL, 66477597976LL, 24703556361LL, 33655218998LL, 26454449742LL, 65954705312LL, 50665436085LL, 33100361705LL, 34127233756LL, 16192442154LL, 66203687665LL, 18079962640LL, 64162045075LL, 56013821712LL, 41526121140LL, 18363315232LL, 48561840625LL, 59338016239LL, 64020842789LL, 9819091455LL, 56211121631LL, 62722840733LL, 47395129654LL, 64861158828LL, 46913727747LL, 45830810873LL, 25954896LL, 65695400197LL, 56669124425LL, 19632747591LL, 9655046745LL, 18912176411LL, 5563776904LL, 21896324920LL, 67723497377LL, 52642025482LL, 67096155889LL, 47481369494LL, 32384553667LL, 6151887298LL, 28677536551LL, 37589469357LL, 56602726009LL, 39910023564LL, 63256349319LL, 831760459LL, 31241047125LL, 61092718546LL, 41226079905LL, 14016240651LL, 31885676152LL, 67880433587LL, 28081965693LL, 40172630901LL, 52049024611LL, 19511963033LL, 56068252405LL, 43713645845LL, 50202739409LL, 34787146052LL, 8445579363LL, 9550213507LL, 35385124157LL, 27238607396LL, 39543670060LL, 53137590321LL, 41875069108LL, 27264835613LL, 20519204951LL, 10790871557LL, 15826050325LL, 12275936458LL, 59580159038LL, 2193888357LL, 19795907792LL, 17531579158LL, 67899903734LL, 23921469176LL, 37630637549LL, 11520134926LL, 67572679334LL, 14133728431LL, 14882994842LL, 29611143987LL, 17425986694LL, 61566414376LL, 64795631810LL, 58135239422LL, 30702156803LL, 55634288426LL, 29270471768LL, 45943555611LL, 29735324004LL, 30315703285LL, 3228639139LL, 55229523718LL, 63530305030LL, 40242434488LL, 35977588456LL, 11596721796LL, 12649130801LL, 18199359434LL, 45767418087LL, 56752046203LL, 7379786208LL, 4863941267LL, 49770411190LL, 55142736954LL, 61526790974LL, 15808325904LL, 12041499345LL, 9522629829LL, 7775101163LL, 64204566039LL, 61858800721LL, 35150339547LL, 42166890656LL, 20426439362LL, 1834558076LL, 37299261327LL, 6122425525LL, 61331692534LL, 31338322171LL, 33423068559LL, 39188196339LL, 64795482253LL, 34278278204LL, 37524118934LL, 16422840662LL, 33914348684LL, 68271227938LL, 66273786097LL, 32166190586LL, 63275351801LL, 54206854406LL, 9689723524LL, 13311133101LL, 50132139936LL, 46213805875LL, 45203945849LL, 7925365128LL, 12261624641LL, 27456230772LL, 40177907564LL, 46220151027LL, 3706636693LL, 43067142066LL, 53683395279LL, 40344328318LL, 18959186505LL, 42582931759LL, 53701331240LL, 58305137335LL, 55558871886LL, 47156378271LL, 62994720567LL, 63530960258LL, 29259407865LL, 37460565629LL, 30460693273LL, 6243186795LL, 10072110617LL, 28093535704LL, 46999136195LL, 25333454647LL, 8987341753LL, 40596653070LL, 15959199158LL, 25129866017LL, 46647714093LL, 32404505400LL, 46238349213LL, 50083850466LL, 37804248121LL, 47332920124LL, 6140261925LL, 29876488560LL, 45723151215LL, 58520689706LL, 36635009165LL, 47426425173LL, 22149675786LL, 19716251194LL, 18035214468LL, 15929449727LL, 21591156783LL, 4925250483LL, 61064483385LL, 64179142625LL, 19400403345LL, 49680890399LL, 41654563325LL, 1222113560LL, 43920180403LL, 42489737769LL, 66373873199LL, 36627620650LL, 40972417605LL, 30536850744LL, 66119659739LL, 45718864381LL, 8348257398LL, 2084502659LL, 27501884185LL, 42503631053LL, 16946217068LL, 53335192823LL, 47786621228LL, 49458200599LL, 14310768553LL, 34231452611LL, 65742374740LL, 29603871947LL, 48890768690LL, 62928215698LL, 65330439437LL, 50319828420LL, 32238304801LL, 36432124292LL, 50241755342LL, 36531884208LL, 51282207261LL, 57511972749LL, 21049109701LL, 60699418939LL, 14293140593LL, 54302703872LL, 63488778389LL, 11367205359LL, 11086689151LL, 388570845LL, 23749688855LL, 53008048518LL, 63823791555LL, 4039980339LL, 24176107023LL, 48854522006LL, 24801035788LL, 3413805894LL, 52087884575LL, 11796749826LL, 13015533224LL, 41233172043LL, 48273548466LL, 30863138279LL, 49352603354LL, 1293315344LL, 8020665093LL, 54274915521LL, 65034896904LL, 11342825587LL, 27751863494LL, 18420596469LL, 4724977599LL, 61898161743LL, 12130563799LL, 60769623333LL, 27038505214LL, 44577137740LL, 20771444607LL, 61793632799LL, 30273092932LL, 56753516282LL, 24850481863LL, 2652785257LL, 67943869548LL, 48381265692LL, 50436312149LL, 25783355301LL, 32727130159LL, 63775482717LL, 181332352LL, 19052862868LL, 65208909780LL, 17503890847LL, 34987407356LL, 10584709850LL, 25040399072LL, 10103813754LL, 58968278455LL, 40358179608LL, 37637660139LL, 55895571290LL, 39252922624LL, 62937545900LL, 40451526508LL, 12517316732LL, 63192879536LL, 45035649928LL, 21996061584LL, 33595055447LL, 12209568100LL, 36432617675LL, 49522016830LL, 66548273368LL, 8567429815LL, 35691749854LL, 39056122609LL, 45550648681LL, 55109657828LL, 65457507779LL, 28831740046LL, 57582028466LL, 17527563200LL, 2591900845LL, 8848457823LL, 60531565141LL, 15914217226LL, 48106020726LL, 68018397804LL, 5004326095LL, 63253145094LL, 44809816633LL, 17225687408LL, 1233165678LL, 2999280769LL, 18956333069LL, 10094302470LL, 33798742835LL, 15746802456LL, 49317964805LL, 20705723543LL, 954907599LL, 37963736437LL, 12390192039LL, 1139724022LL, 3900607557LL, 62905497676LL, 39550378809LL, 48831655835LL, 65937769475LL, 46147865755LL, 20508381160LL, 18065122935LL, 20060182579LL, 36949769044LL, 33401647102LL, 55814749836LL, 68412437289LL, 9272973945LL, 66144431245LL, 37301723444LL, 55651156924LL, 49092220319LL, 19096106736LL, 32834122955LL, 26801011748LL, 44155123822LL, 30377776183LL, 1210483397LL, 29059471333LL, 67398727378LL, 61211230951LL, 62434233400LL, 27541908272LL, 60829062042LL, 68371631702LL, 43584742101LL, 25203062195LL, 53916982744LL, 20574619315LL, 2772337469LL, 31580375575LL, 56028801172LL, 58763181546LL, 52313220092LL, 18635497866LL, 33625597631LL, 67507025948LL, 52130461659LL, 46775491703LL, 44921381930LL, 44839264431LL, 18844485253LL, 3020254425LL, 42590132376LL, 58281410103LL, 16057187292LL, 31237999277LL, 7685816894LL, 41460653959LL, 315654128LL, 34143934061LL, 56604483922LL, 61785954946LL, 18459047578LL, 14890888305LL, 42349975467LL, 41144783931LL, 60212295222LL, 13689836788LL, 36279545329LL, 38707371556LL, 4230886508LL, 41226369772LL, 9203279323LL, 68382662197LL, 33250094531LL, 41783764051LL, 560781983LL, 49721962889LL, 11034766178LL, 39068886423LL, 23311085954LL, 65014021765LL, 39518336233LL, 18915265838LL, 42450075314LL, 17784209191LL, 53253758916LL, 25396556192LL, 19873504996LL, 63654853943LL, 62458007221LL, 54484336584LL, 62835743649LL, 4913970443LL, 67125693003LL, 14136410994LL, 4939397173LL, 34181666026LL, 48879515639LL, 44686354056LL, 35532821745LL, 67796157750LL, 55892071730LL, 26209004813LL, 44626439849LL, 48041991749LL, 55538964458LL, 28823648129LL, 23354104374LL, 34590349460LL, 2844183369LL, 28993558284LL, 28292738938LL, 64100712524LL, 1649154107LL, 4946307637LL, 22714961331LL, 9464993920LL, 49171843276LL, 52635523422LL, 68405915089LL, 62421948321LL, 66012724128LL, 18924464061LL, 25828426042LL, 6801227206LL, 22842058597LL, 49690363497LL, 11181235162LL, 66373294412LL, 59596029796LL, 30892152661LL, 18957382992LL, 11285580729LL, 57223167416LL, 39736233951LL, 43418221657LL, 46837737920LL, 25630630491LL, 68386279696LL, 10158748161LL, 49379594699LL, 37013598321LL, 27624861406LL, 40863814327LL, 28855202094LL, 56768675713LL, 10194390165LL, 39034623269LL, 19192670346LL, 1474301490LL, 46381127030LL, 27984858745LL, 65842188205LL, 9952558746LL, 63908330467LL, 36006267861LL, 57245441314LL, 58840150925LL, 43181154796LL, 37473287077LL, 12801678356LL, 27845695481LL, 30077757180LL, 1209803881LL, 49589590370LL, 46088988443LL, 38250794700LL, 26783448778LL, 31096693285LL, 40207762315LL, 3759696397LL, 20022823398LL, 10789608907LL, 29196636157LL, 27995066368LL, 8324063359LL, 18977677266LL, 36037804936LL, 54210471371LL, 33149068936LL, 15936164611LL, 30678499232LL, 21599713662LL, 5045648190LL, 46055704420LL, 59084533518LL, 20183904843LL, 31111699654LL, 22352693733LL, 21921563072LL, 58237473657LL, 24584838052LL, 26534875815LL, 51856319886LL, 5845238062LL, 3875404029LL, 4735201948LL, 65574335379LL, 32457998433LL, 60969617214LL, 41281090678LL, 33717940853LL, 8648502095LL, 22249125437LL, 7857928159LL, 15851408776LL, 46437138103LL, 13291218989LL, 25264296858LL, 9001723870LL, 35700800770LL, 33184647432LL, 16191232143LL, 41288106012LL, 20386249700LL, 26243981225LL, 8521983LL, 60220674164LL, 50584496634LL, 11996259582LL, 40373843606LL, 31318168363LL, 35396153507LL, 28181606859LL, 45862396888LL, 12616879373LL, 5387970410LL, 31001397010LL, 6920619398LL, 49044401612LL, 21880903571LL, 68269865962LL, 56850610430LL, 63130744785LL, 11863700661LL, 6984954393LL, 42859788480LL, 30937038423LL, 47430177120LL, 67429786844LL, 37703289796LL, 6103214334LL, 26337408208LL, 40257925935LL, 30975430799LL, 64669939073LL, 56793797755LL, 52197790506LL, 50393085760LL, 4006110200LL, 31596985023LL, 25615470834LL, 18679838262LL, 58479085371LL, 55183010290LL, 35756171864LL, 39626155884LL, 4787823783LL, 32669824120LL, 35955634483LL, 14450948507LL, 60825236551LL, 61815956749LL, 29386142581LL, 19128849216LL, 43034855460LL, 29421962082LL, 19274733946LL, 26089940942LL, 30185499951LL, 61284709994LL, 41371751840LL, 11750377887LL, 13091487806LL, 689978481LL, 44760049422LL, 36539729814LL, 27591111569LL, 47884462675LL, 45253486439LL, 41347168766LL, 56428215034LL, 33537662743LL, 29412315688LL, 4180193654LL, 40114079059LL, 48597801758LL, 57139852182LL, 19849213524LL, 39206202053LL, 18931824028LL, 15226518443LL, 67251029184LL, 8443439420LL, 33204083563LL, 2971589122LL, 64315716569LL, 46636470125LL, 10458553186LL, 2298787131LL, 12939927454LL, 51540689012LL, 15760028424LL, 664685368LL, 1157848316LL, 19358978972LL, 39887601208LL, 31715026927LL, 58520891144LL, 30647245606LL, 49883955010LL, 13103726573LL, 45256002653LL, 24218171474LL, 67710137101LL, 42353401412LL, 60425382960LL, 57050017684LL, 39608266036LL, 18780528652LL, 16303108971LL, 17584292880LL, 7694489684LL, 64180910504LL, 11907237924LL, 20511182632LL, 40793213202LL, 55418994287LL, 13402195853LL, 67870433116LL, 34025256280LL, 59404775008LL, 66247476232LL, 60385622977LL, 47879137337LL, 6412054088LL, 46652775989LL, 49330251447LL, 54919886954LL, 6970840116LL, 37459409901LL, 67790234536LL, 67720243185LL, 63567091622LL, 17309112404LL, 51170155985LL, 44268856404LL, 35440228065LL, 5464697315LL, 21150232586LL, 43355840695LL, 66789297973LL, 37321488138LL, 25477473784LL, 13674557967LL, 41885610881LL, 30929533043LL, 25975126710LL, 53520798240LL, 7463963298LL, 1939951326LL, 65573143514LL, 12949508352LL, 20678759862LL, 63411720763LL, 16338910562LL, 66897747LL, 29287513141LL, 17638306872LL, 18257690130LL, 20395998494LL, 52933769020LL, 60481513054LL, 27652635443LL, 49521753760LL, 62500024758LL, 22310955919LL, 63157905107LL, 68420584174LL, 67680176298LL, 5033452990LL, 9995177343LL, 54715111196LL, 29037088116LL, 19093658738LL, 26317580718LL, 48325259574LL, 15125489362LL, 45577808933LL, 9016967478LL, 49654949802LL, 4486961683LL, 43422056893LL, 25236362031LL, 408036331LL, 42162890544LL, 53751344015LL, 57947419243LL, 41864765289LL, 23819248943LL, 12877572885LL, 45988726479LL, 52859577865LL, 19358772350LL, 18453003471LL, 21983130715LL, 63844775374LL, 2585051541LL, 44162886839LL, 48954574636LL, 59456931513LL, 31946521112LL, 15782315654LL, 3454394468LL, 26914626431LL, 37189458296LL, 55072528641LL, 26377797570LL, 42606264699LL, 54359708450LL, 51741848037LL, 49739031215LL, 13372101553LL, 50584058412LL, 53879290277LL, 39346971851LL, 62412783790LL, 44624714396LL, 25607163249LL, 46418310024LL, 38621925524LL, 3498548857LL, 67480077270LL, 30691394424LL, 37629408801LL, 58968067130LL, 62742242888LL, 40852893386LL, 13327997033LL, 39983032208LL, 56709818396LL, 23415203072LL, 52894283299LL, 12996670813LL, 19754454051LL, 29881048979LL, 57483541725LL, 40153041398LL, 46934443410LL, 21909687315LL, 60365026428LL, 27516822332LL, 36444805364LL, 45213998974LL, 21822298418LL, 20816967182LL, 29081726517LL, 44753195937LL, 35640984333LL, 50639287773LL, 63813125564LL, 11451438070LL, 55619707234LL, 33804096192LL, 10959077295LL, 23877981585LL, 6331900585LL, 41088309275LL, 36628408251LL, 20072030304LL, 17480468267LL, 33198753488LL, 5202868178LL, 20932348023LL, 29801165487LL, 52135439762LL, 58232435009LL, 58674678452LL, 34852442638LL, 674041848LL, 54206642230LL, 43480225650LL, 57047867585LL, 58350248497LL, 8187483409LL, 22049664568LL, 31935664895LL, 63861816007LL, 4695812377LL, 39878255707LL, 28622941895LL, 60524984095LL, 62565085036LL, 51013536363LL, 39728842059LL, 49178944725LL, 52194254693LL, 56753481914LL, 61631114953LL, 21828210909LL, 55938406763LL, 41584424781LL, 33308058241LL, 68535729743LL, 33912908294LL, 18264901886LL, 9182212273LL, 30796432547LL, 459789389LL, 22926674544LL, 55451274338LL, 15860682319LL, 59125100581LL, 4441042296LL, 14318563964LL, 42243384045LL, 19339953456LL, 28431118366LL, 19881540897LL, 41233661396LL, 7580667147LL, 15915197044LL, 27758126349LL, 27586171692LL, 46230911339LL, 49893774763LL, 59643682311LL, 48644795196LL, 54784883382LL, 9213312527LL, 41709996628LL, 4648142697LL, 33990530496LL, 38142501095LL, 26294692934LL, 17561594990LL, 1825070411LL, 62349938016LL, 50869810647LL, 34069928979LL, 34896808823LL, 16805238374LL, 5027396759LL, 23108307233LL, 6532900184LL, 44712480318LL, 55152582565LL, 31353233896LL, 22863683437LL, 24939338195LL, 27121151296LL, 22822379514LL, 60428535821LL, 48034803845LL, 14061800862LL, 65035781765LL, 499218730LL, 14305039977LL, 3047468293LL, 51044321734LL, 17738228714LL, 22820957548LL, 29580303461LL, 21427109083LL, 864163104LL, 37066726559LL, 50969545623LL, 50894605480LL, 65255559069LL, 44669417604LL, 37064120549LL, 36788768051LL, 14239922314LL, 27560434481LL, 44863712944LL, 19682921750LL, 26454171615LL, 7348851210LL, 27834617910LL, 25309884491LL, 41189144734LL, 53673062421LL, 39039555333LL, 25629267060LL, 51325531120LL, 7935991960LL, 61964506719LL, 35979826839LL, 25713406658LL, 49732595935LL, 66567856191LL, 535805623LL, 3749337089LL, 55558554856LL, 11625923196LL, 15954429380LL, 41567081101LL, 7883084514LL, 39631901919LL, 41155882942LL, 55399726239LL, 9913291321LL, 1626749353LL, 65164083109LL, 35653765528LL, 44256801107LL, 29064985400LL, 67466992871LL, 42388349209LL, 13483480953LL, 19498646290LL, 62773761983LL, 25181583201LL, 37639494482LL, 48393865906LL, 27158809001LL, 11687861516LL, 25121362214LL, 46415276396LL, 4786455825LL, 37788698680LL, 6385548917LL, 15992469754LL, 39333214968LL, 41498328358LL, 21661216408LL, 15522045578LL, 31712297694LL, 13221630401LL, 23381370772LL, 47510098714LL, 20922704517LL, 47807192092LL, 16760332389LL, 45457365633LL, 28270774227LL, 34763450187LL, 26321109031LL, 28975001091LL, 52522334490LL, 37622594620LL, 54382815717LL, 19448110816LL, 58578519447LL, 31207737467LL, 67262894066LL, 64755557356LL, 12621731576LL, 43978496119LL, 55510806687LL, 62001920764LL, 52146063LL, 29352929855LL, 18360939212LL, 741466199LL, 12978889799LL};

/* Cooley-Tukey NTT */
void ntt(POLY_64 *a)
{
	uint64_t t = N >> 1;
	uint64_t m, i, j;
	uint64_t j1, j2;
	
	uint64_t x, u;
	
	for (j = 0; j < t; j++)
	{
		x = montgomery(con_add(a->poly[j], Q), MONTGOMERY_CONVERT_FACTOR);
		u = montgomery(con_add(a->poly[j + t], Q), root[1]);
		a->poly[j] = con_sub(x + u, Q);
		a->poly[j + t] = con_add(x - u, Q);
	}
	
	for (m = 2; m < (N >> 1); m <<= 1)
	{
		t >>= 1;
		for (i = 0; i < m; i++)
		{
			j1 = (i * t) << 1;
			j2 = j1 + t - 1;
			
			for (j = j1; j <= j2; j++)
			{
				x = a->poly[j];
				u = montgomery(a->poly[j + t], root[m + i]);
				a->poly[j] = con_sub(x + u, Q);
				a->poly[j + t] = con_add(x - u, Q);
			}
		}
	}

	for (i = 0; i < m; i++)
	{
		j = i << 1;
		
		x = a->poly[j];
		u = montgomery(a->poly[j + 1], root[m + i]);
		a->poly[j] = con_sub(x + u, Q);
		a->poly[j + 1] = con_add(x - u, Q);
	}
}

/* Gentleman-Sande INTT */
void intt(POLY_64 *a)
{
	uint64_t t = 2;
	uint64_t m, i, j;
	uint64_t j1, j2;
	uint64_t h = N >> 1;

	uint64_t x, y;
	
	for (i = 0; i < h; i++)
	{
		j = i << 1;
		
		x = con_sub(a->poly[j] + a->poly[j + 1], Q);
		y = con_add(a->poly[j] - a->poly[j + 1], Q);
		a->poly[j] = x;
		a->poly[j + 1] = montgomery(y, root_inv[h + i]);
	}
	
	for (m = N >> 1; m > 2; m >>= 1)
	{
		j1 = 0;
		h >>= 1;

		for (i = 0; i < h; i++)
		{
			j2 = j1 + t - 1;
			
			for (j = j1; j <= j2; j++)
			{
				x = con_sub(a->poly[j] + a->poly[j + t], Q);
				y = con_add(a->poly[j] - a->poly[j + t], Q);
				a->poly[j] = x;
				a->poly[j + t] = montgomery(y, root_inv[h + i]);
			}
			j1 += t << 1;
		}
		t <<= 1;
	}

	for (j = 0; j < t; j++)
	{
		x = con_sub(a->poly[j] + a->poly[j + t], Q);
		y = con_add(a->poly[j] - a->poly[j + t], Q);
		a->poly[j] = montgomery(x, inv_n);
		a->poly[j + t] = montgomery(y, root_inv[1]);
	}
}
